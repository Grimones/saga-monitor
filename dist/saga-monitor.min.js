/**
 * Copyright (c) 2018, Travis Clarke
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("redux-saga/effects")):"function"==typeof define&&define.amd?define(["exports","redux-saga/effects"],t):t(e.SagaMonitor={},e.ReduxSaga.effects)}(this,function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){f(e,t,n[t])})}return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function y(e){return p(e)||h(e)||g()}function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}
function h(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function v(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(console.group){var r;(r=console).group.apply(r,t)}else{var o;console.log(""),(o=console).log.apply(o,[U+z].concat(t)),U+=X}}function b(){console.groupEnd?console.groupEnd():U=U.substr(0,U.length-X.length)}function T(e){return"function"==typeof e?"".concat(e.name):"string"==typeof e?"'".concat(e,"'"):e}function E(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"===n(e)||null===e||void 0===e}function S(e){0===e.getRootIds().length&&console.log("Saga monitor: No effects to log"),console.log(""),console.log("Saga monitor:",Date.now(),(new Date).toISOString());var t=!0,n=!1,r=void 0;try{for(var o,a=e.getRootIds()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){m(e,o.value)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}console.log("")}function m(e,t){var n=e.get(t),r=e.getChildIds(t),o=w(n);if(0===r.length){var a;(a=console)[o.logMethod].apply(a,y(o.getLog()))}else{v.apply(void 0,y(o.getLog()));var f=!0,c=!1,l=void 0;try{for(var s,i=r[Symbol.iterator]();!(f=(s=i.next()).done);f=!0){m(e,s.value)}}catch(e){c=!0,l=e}finally{try{f||null==i.return||i.return()}finally{if(c)throw l}}b()}}function w(e){var n=e.status===G,r=e.status===q,o=new Y(n,r);if(o.addLabel(e.winner?r?"âœ˜":"âœ“":"").addLabel(e.label),e.root)o.addEffectType("root").resetStyle().addCall(e.saga.name,e.args).addDescResult(e);else if(_(e.effect))o.addValue(e.effect.name).addDescResult(e,!0);else if(V(e.effect))o.addEffectType("promise").resetStyle().addDescResult(e);else if(F(e.effect)){var a=e.effect,f=a.type,c=a.payload
;if(f===t.effectTypes.TAKE)o.addEffectType("take").resetStyle().addValue(null==c.channel?c.pattern:c).addDescResult(e);else if(f===t.effectTypes.PUT)o.addEffectType("put").resetStyle().addDescResult(Object.assign({},e,{result:c}));else if(f===t.effectTypes.ALL)o.addEffectType("all").resetStyle().addDescResult(e,!0);else if(f===t.effectTypes.RACE)o.addEffectType("race").resetStyle().addDescResult(e,!0);else if(f===t.effectTypes.CALL)o.addEffectType("call").resetStyle().addCall(c.fn.name,c.args).addDescResult(e);else if(f===t.effectTypes.CPS)o.addEffectType("cps").resetStyle().addCall(c.fn.name,c.args).addDescResult(e);else if(f===t.effectTypes.FORK)o.addEffectType(c.detached?"spawn":"fork").resetStyle().addCall(c.fn.name,c.args).addDescResult(e);else if(f===t.effectTypes.JOIN)o.addEffectType("join").resetStyle().addDescResult(e);else if(f===t.effectTypes.CANCEL)o.addEffectType("cancel").resetStyle().appendData(c.name);else if(f===t.effectTypes.SELECT)o.addEffectType("select").resetStyle().addCall(c.selector.name,c.args).addDescResult(e);else if(f===t.effectTypes.ACTION_CHANNEL)o.addEffectType("actionChannel").resetStyle().addValue(null==c.buffer?c.pattern:c).addDescResult(e);else if(f===t.effectTypes.CANCELLED)o.addEffectType("cancelled").resetStyle().addDescResult(e);else if(f===t.effectTypes.FLUSH)o.addEffectType("flush").resetStyle().addValue(c).addDescResult(e);else if(f===t.effectTypes.GET_CONTEXT)o.addEffectType("getContext").resetStyle().addValue(c).addDescResult(e);else{if(f!==t.effectTypes.SET_CONTEXT)throw Error("Invalid effect type ".concat(f));o.addEffectType("setContext").resetStyle().addValue(c).addDescResult(e,!0)}}else o.addEffectType("unknown").resetStyle().addDescResult(e);return o}function D(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()}function O(e){var t=D();Object.assign(e,{end:t,duration:t-e.start})}function R(e,t){var n=te.get(e);M(t)?t.toPromise().then(function(n){t.isCancelled()?j(e):R(e,n)},function(t){return C(e,t)}):(O(n),n.status=K,n.result=t,
J(n.effect)&&I(e,t))}function C(e,t){var n=te.get(e);O(n),n.status=q,n.error=t,J(n.effect)&&I(e,t)}function j(e){var t=te.get(e);O(t),t.status=G}function I(e,t){var n=Object.keys(t)[0],r=!0,o=!1,a=void 0;try{for(var f,c=te.getChildIds(e)[Symbol.iterator]();!(r=(f=c.next()).done);r=!0){var l=f.value,s=te.get(l);s.label===n&&(s.winner=!0)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}}function k(){function e(e){u&&(console[l]("%c Saga monitor: effectTriggered:",g,e),te.set(e.effectId,Object.assign({},e,{status:$,start:D()})))}function t(e,t){d&&(console[l]("%c effectResolved:",g,e,t),R(e,t))}function n(e,t){y&&(console[l]("%c effectRejected:",g,e,t),C(e,t))}function r(e){p&&(console[l]("%c effectCancelled:",g,e),j(e))}function o(e){h&&console[l]("%c actionDispatched:",g,e)}var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=c({},ne,a),l=f.level,s=f.verbose,i=f.color,u=f.effectTrigger,d=f.effectResolve,y=f.effectReject,p=f.effectCancel,h=f.actionDispatch,g=["color: ".concat(i),"font-weight: bold"].join(";");return s&&console[l]("View Sagas by executing %c $$LogSagas()",g,"in the console"),{effectTriggered:e,effectResolved:t,effectRejected:n,effectCancelled:r,actionDispatched:o}}var A=function(e){return"@@redux-saga/"+e},L=A("IO"),x=A("TASK"),P=function(e){return"function"==typeof e},N=Array.isArray,V=function(e){return e&&P(e.then)},_=function(e){return e&&P(e.next)&&P(e.throw)},M=function(e){return e&&e[x]},F=function(e){return e&&e[L]},$="PENDING",K="RESOLVED",q="REJECTED",G="CANCELLED",H="undefined"!=typeof window&&window.document,J=function(e){return F(e)&&e.type===t.effectTypes.RACE},U="",X="   ",z="â–¼",B=function(){function e(){r(this,e),this.logs=[],this.suffix=[]}return a(e,[{key:"add",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!H&&"string"==typeof e){var o=e;e=e.replace(/^%c\s*/,""),e!==o&&n.shift()}return this.logs.push({msg:e,args:n}),this}},{key:"appendData",value:function(){var e
;return(e=this.suffix).push.apply(e,arguments),this}},{key:"addValue",value:function(e){return E(e)?this.add(e):H?this.add("%O",e):this.add("%s",require("util").inspect(e)),this}},{key:"addCall",value:function(e,t){var n=this;return t.length?(this.add(e),this.add("("),t.forEach(function(e,r){n.addValue(T(e)),n.addValue(r===t.length-1?")":", ")})):this.add("".concat(e,"()")),this}},{key:"getLog",value:function(){var e=[],t=[],n=!0,r=!1,o=void 0;try{for(var a,f=this.logs[Symbol.iterator]();!(n=(a=f.next()).done);n=!0){var c=a.value,l=c.msg,s=c.args;e.push(l),t.push.apply(t,y(s))}}catch(e){r=!0,o=e}finally{try{n||null==f.return||f.return()}finally{if(r)throw o}}return[e.join("")].concat(t,y(this.suffix))}}]),e}(),Q="color: red",W="color: #ccc",Y=function(e){function t(e,n){var o;return r(this,t),o=d(this,s(t).call(this)),o.logMethod=n?"error":"log",o.styleOverride=function(t){return e?W:n?Q:t},o}return l(t,e),a(t,[{key:"resetStyle",value:function(){return this.add("%c",this.styleOverride("color: black"))}},{key:"addLabel",value:function(e){return e?this.add("%c ".concat(e," "),this.styleOverride("font-weight: bold")):this}},{key:"addEffectType",value:function(e){return this.add("%c ".concat(e," "),this.styleOverride("color: blue"))}},{key:"addDescResult",value:function(e,t){var n=e.status,r=e.result,o=e.error,a=e.duration;return n!==K||t?n===q?this.appendData("ðŸ¡² âš ",o):n===$?this.appendData("âŒ›"):n===G&&this.appendData("ðŸ¡² Cancelled!"):N(r)?(this.addValue(" ðŸ¡² "),this.addValue(r)):this.appendData("ðŸ¡²",r),n!==$&&this.appendData("(".concat(a.toFixed(2),"ms)")),this}}]),t}(B),Z=function(){function e(){r(this,e),this.rootIds=[],this.map={},this.childIdsMap={}}return a(e,[{key:"get",value:function(e){return this.map[e]}},{key:"set",value:function(e,t){this.map[e]=t,null==this.childIdsMap[t.parentEffectId]&&(this.childIdsMap[t.parentEffectId]=[]),this.childIdsMap[t.parentEffectId].push(e)}},{key:"setRootEffect",value:function(e,t){this.rootIds.push(e),this.set(e,Object.assign({root:!0},t))}},{key:"getRootIds",
value:function(){return this.rootIds}},{key:"getChildIds",value:function(e){return this.childIdsMap[e]||[]}}]),e}(),ee=void 0===window.document&&"ReactNative"===navigator.product?global:H?window:null,te=new Z,ne={level:"debug",color:"#03A9F4",rootSagaStart:!1,effectTrigger:!1,effectResolve:!1,effectReject:!1,effectCancel:!1,actionDispatch:!1};ee&&(ee.$$LogSagas=function(){return S(te)}),e.logSaga=S,e.default=k,Object.defineProperty(e,"__esModule",{value:!0})});